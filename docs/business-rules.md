# 회의실 예약 시스템 비즈니스 규칙

## 1. 예약 관련 규칙

### 1.1 예약 시간 규칙
- **BR-001**: 예약 시간은 30분 단위로만 선택 가능하다.
- **BR-002**: 예약 가능 시간은 오전 8시부터 오후 7시까지이다 (08:00 ~ 19:00).
- **BR-003**: 예약은 같은 날짜 내에서만 가능하다. 시작일과 종료일이 동일해야 한다.
- **BR-004**: 시작 시간은 종료 시간보다 이전이어야 한다 (startAt < endAt).

### 1.2 점심시간 규칙
- **BR-005**: 점심시간(11:30 ~ 12:30)에는 예약할 수 없다.
- **BR-006**: 11:00 ~ 11:30 예약은 가능하다.
- **BR-007**: 13:00 이후 예약은 가능하다.

### 1.3 주말 및 공휴일 규칙
- **BR-008**: 토요일에는 예약할 수 없다.
- **BR-009**: 일요일에는 예약할 수 없다.
- **BR-010**: 한국 공휴일에는 예약할 수 없다.
- **BR-011**: 공휴일은 다음을 포함한다:
  - 고정 공휴일: 신정, 삼일절, 어린이날, 현충일, 광복절, 개천절, 한글날, 크리스마스
  - 설날 연휴 (음력 기준)
  - 추석 연휴 (음력 기준)
  - 부처님 오신 날 (음력 기준)

### 1.4 예약 중복 규칙
- **BR-012**: 동일 회의실의 예약 시간이 겹치면 예약할 수 없다.
- **BR-013**: 예약 시간 중복 체크는 다음 경우를 포함한다:
  - 기존 예약의 시작 시간이 새 예약 시간 내에 있는 경우
  - 기존 예약의 종료 시간이 새 예약 시간 내에 있는 경우
  - 기존 예약이 새 예약을 완전히 포함하는 경우
- **BR-014**: 예약 수정 시에도 동일한 중복 체크가 필요하다 (자기 자신 제외).

### 1.5 예약 취소 규칙
- **BR-015**: 일반 사용자는 본인의 예약만 취소할 수 있다.
- **BR-016**: 관리자는 모든 예약을 취소할 수 있다.
- **BR-017**: 예약 취소 시 예약 데이터는 완전히 삭제된다.

## 2. 회의실 관련 규칙

### 2.1 회의실 상태 규칙
- **BR-018**: 회의실 상태는 "활성(ACTIVE)" 또는 "비활성(CLOSED)" 두 가지이다.
- **BR-019**: 비활성화된 회의실은 예약할 수 없다.
- **BR-020**: 회의실은 삭제하지 않고 비활성화 상태로만 변경한다.
- **BR-021**: 미래 예약이 있는 회의실은 비활성화할 수 없다.
- **BR-022**: 미래 예약이 없는 회의실만 비활성화할 수 있다.

### 2.2 회의실 정보 규칙
- **BR-023**: 회의실 이름, 건물, 층, 최대 수용 인원은 필수 입력 항목이다.
- **BR-024**: 최대 수용 인원은 양수여야 한다.
- **BR-025**: 회의실 정보는 건물, 층, 이름 순으로 정렬하여 표시한다.

## 3. 사용자 관련 규칙

### 3.1 사용자 권한 규칙
- **BR-026**: 사용자 권한은 "관리자(ADMIN)" 또는 "사용자(USER)" 두 가지이다.
- **BR-027**: 기본 권한은 "사용자(USER)"이다.
- **BR-028**: 관리자는 다음 기능을 사용할 수 있다:
  - 회의실 생성
  - 회의실 수정
  - 회의실 비활성화
  - 예약 생성
  - 예약 취소 (모든 예약)
  - 사용자 관리
- **BR-029**: 일반 사용자는 다음 기능을 사용할 수 있다:
  - 예약 생성
  - 예약 취소 (본인 예약만)
- **BR-030**: 비로그인 사용자는 다음 기능만 사용할 수 있다:
  - 회의실 목록 조회
  - 예약 목록 조회
  - 예약 상세 조회

### 3.2 사용자 정보 규칙
- **BR-031**: 사용자 정보는 사번(employeeId)을 기준으로 관리된다.
- **BR-032**: 사번은 고유해야 한다.
- **BR-033**: SSO 로그인 시 사번을 기준으로 사용자 정보를 자동으로 등록/업데이트한다.
- **BR-034**: 사용자 이름은 필수 입력 항목이다.
- **BR-035**: 이메일과 부서는 선택 입력 항목이다.

## 4. 데이터 저장 규칙

### 4.1 날짜/시간 저장 규칙
- **BR-036**: 예약 시간은 선택한 시간 그대로 데이터베이스에 저장된다.
- **BR-037**: 타임존 변환 없이 로컬 시간으로 저장된다.
- **BR-038**: 날짜/시간은 ISO 8601 형식으로 저장된다.

### 4.2 데이터 무결성 규칙
- **BR-039**: 회의실 삭제 시 해당 회의실의 모든 예약도 함께 삭제된다 (CASCADE).
- **BR-040**: 사용자 삭제 시 해당 사용자의 예약은 사용자 정보만 NULL로 설정된다 (SET NULL).
- **BR-041**: 모든 엔티티는 UUID를 기본 키로 사용한다.
- **BR-042**: 모든 엔티티는 생성일시(createdAt)와 수정일시(updatedAt)를 자동으로 관리한다.

## 5. 화면 표시 규칙

### 5.1 타임라인 표시 규칙
- **BR-043**: 타임라인에는 08:00부터 19:00까지의 시간대가 표시된다.
- **BR-044**: 예약 블록에는 예약자 이름이 표시된다.
- **BR-045**: 점심시간(11:30 ~ 12:30) 구간은 시각적으로 구분하여 표시된다.
- **BR-046**: 공휴일 선택 시 타임라인에는 "공휴일 예약 불가" 메시지가 표시된다.
- **BR-047**: 타임라인 시간 표시는 구분선과 정렬되어 표시된다.

### 5.2 달력 표시 규칙
- **BR-048**: 달력에서 토요일과 일요일은 비활성화되어 표시된다.
- **BR-049**: 달력에서 공휴일은 빨간색으로 표시된다.
- **BR-050**: 달력은 항상 열려있는 상태로 표시된다 (메인 화면).

### 5.3 검색 및 필터 규칙
- **BR-051**: 회의실 검색은 이름, 건물, 층으로 검색 가능하다.
- **BR-052**: 사용자 검색은 이름, 사번, 부서로 검색 가능하다.
- **BR-053**: 검색은 대소문자 구분 없이 수행된다.
- **BR-054**: 검색과 필터는 동시에 적용 가능하다.

## 6. 시스템 동작 규칙

### 6.1 로그인/로그아웃 규칙
- **BR-055**: 최초 화면 진입 시 SSO 로그인을 시도하지 않는다.
- **BR-056**: 로그인 버튼 클릭 시 SSO 로그인 페이지로 리다이렉트된다.
- **BR-057**: SSO 로그인 성공 후 원래 페이지로 리다이렉트된다.
- **BR-058**: 로그인 상태는 쿠키(JSESSIONID)를 기준으로 확인한다.
- **BR-059**: 로그아웃 시 모든 로컬 상태가 초기화된다.

### 6.2 데이터 동기화 규칙
- **BR-060**: 회의실 관리 화면에서 변경 사항이 발생하면 타임라인 화면이 자동으로 업데이트된다.
- **BR-061**: 예약 생성/수정/취소 시 타임라인 화면이 자동으로 업데이트된다.
- **BR-062**: 데이터 업데이트는 한 번만 수행된다 (무한 루프 방지).

## 7. 예외 처리 규칙

### 7.1 에러 처리 규칙
- **BR-063**: 모든 API 에러는 JSON 형태로 반환된다: `{ message: string, detail?: any }`
- **BR-064**: 클라이언트 측 에러는 사용자에게 명확한 메시지로 표시된다.
- **BR-065**: 서버 측 에러는 로그에 기록되고 사용자에게는 일반적인 에러 메시지가 표시된다.

### 7.2 검증 규칙
- **BR-066**: 모든 필수 입력 항목은 클라이언트와 서버 양쪽에서 검증된다.
- **BR-067**: 비즈니스 규칙 위반 시 명확한 에러 메시지를 반환한다.
- **BR-068**: 날짜/시간 형식이 올바르지 않으면 에러를 반환한다.

## 8. 개발 환경 규칙

### 8.1 개발 모드 규칙
- **BR-069**: 개발 모드에서는 SSO 로그인 후 첫 번째 관리자 계정으로 자동 로그인된다.
- **BR-070**: 개발 모드에서는 로그아웃 시 SSO 로그아웃 페이지로 리다이렉트하지 않는다.

### 8.2 환경 변수 규칙
- **BR-071**: 환경 변수는 개발 환경과 프로덕션 환경을 분리하여 관리한다.
- **BR-072**: 환경 변수 파일(.env.development, .env.production)은 버전 관리에 포함하지 않는다.













